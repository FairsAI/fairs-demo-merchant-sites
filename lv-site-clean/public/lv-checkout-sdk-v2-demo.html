<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Louis Vuitton - SDK v2 Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @font-face {
            font-family: 'Futura';
            src: url('/assets/fonts/futurabt-light-webfont.woff2') format('woff2'),
                 url('/assets/fonts/futura-light-bt.ttf') format('truetype');
            font-weight: 300;
            font-style: normal;
            font-display: swap;
        }

        body {
            font-family: 'Futura', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-weight: 300;
            letter-spacing: 0.025em;
            background-color: #f9f9f9;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Futura', sans-serif;
            font-weight: 300;
            letter-spacing: 0.05em;
        }

        .lv-logo {
            height: 24px;
            width: auto;
        }

        .product-card {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .product-card:hover {
            border-color: #000;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .sdk-button {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            margin: 6px;
        }

        .sdk-button:hover {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            transform: translateY(-1px);
        }

        .sdk-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }

        .status-panel {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }

        .status-success {
            background: #f0f9ff;
            border-color: #3b82f6;
        }

        .status-error {
            background: #fef2f2;
            border-color: #ef4444;
        }

        .metrics-display {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 12px;
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
            font-size: 12px;
            color: #4b5563;
        }

        .demo-cart {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            margin-right: 12px;
        }

        .cart-total {
            font-size: 18px;
            font-weight: 600;
            color: #111827;
            text-align: right;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 2px solid #e5e7eb;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    <!-- Header -->
    <header class="sticky top-0 z-50 bg-white border-b border-gray-200">
        <div class="container mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center">
                <span class="text-xs text-gray-600">SDK v2 Demo</span>
            </div>
            
            <!-- Center - Logo -->
            <div class="absolute left-1/2 transform -translate-x-1/2">
                <img src="/assets/images/louis-vuitton-logo.png" 
                     alt="LOUIS VUITTON" class="lv-logo">
            </div>
            
            <!-- Right Side -->
            <div class="flex items-center space-x-6 text-sm">
                <div class="flex items-center">
                    <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                    </svg>
                    <span>Secure Payment</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Page Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-light mb-2">Fairs SDK v2.0 Demo</h1>
            <p class="text-gray-600">Endpoint-First Commerce Integration</p>
        </div>

        <!-- Demo Cart -->
        <div class="max-w-4xl mx-auto">
            <div class="demo-cart">
                <h2 class="text-lg font-normal mb-4">Shopping Cart</h2>
                
                <div class="cart-item">
                    <img src="/assets/images/lv-handbag.jpg" alt="LV Handbag" onerror="this.src='https://via.placeholder.com/60x60?text=LV'">
                    <div class="flex-1">
                        <h3 class="font-medium">Louis Vuitton Handbag</h3>
                        <p class="text-sm text-gray-600">SKU: LV-HB-001 | Black Leather</p>
                        <p class="text-sm text-gray-600">Quantity: 1</p>
                    </div>
                    <div class="text-right">
                        <p class="font-medium">$2,500.00</p>
                    </div>
                </div>

                <div class="cart-item">
                    <img src="/assets/images/lv-scarf.jpg" alt="LV Scarf" onerror="this.src='https://via.placeholder.com/60x60?text=LV'">
                    <div class="flex-1">
                        <h3 class="font-medium">Silk Scarf</h3>
                        <p class="text-sm text-gray-600">SKU: LV-SC-002 | Blue Silk</p>
                        <p class="text-sm text-gray-600">Quantity: 1</p>
                    </div>
                    <div class="text-right">
                        <p class="font-medium">$350.00</p>
                    </div>
                </div>

                <div class="cart-total">
                    Total: $2,850.00
                </div>
            </div>

            <!-- SDK Demo Controls -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8">
                <!-- SDK Initialization -->
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h3 class="text-lg font-normal mb-4">SDK v2 Initialization</h3>
                    
                    <div class="space-y-3">
                        <button id="init-extraction" class="sdk-button w-full">
                            Initialize (Extraction Mode)
                        </button>
                        <button id="init-endpoints" class="sdk-button w-full">
                            Initialize (Endpoint Mode)
                        </button>
                        <button id="init-auto" class="sdk-button w-full">
                            Initialize (Auto Mode)
                        </button>
                    </div>

                    <div id="init-status" class="status-panel mt-4">
                        <strong>Status:</strong> <span id="status-text">Ready to initialize</span>
                    </div>
                </div>

                <!-- Checkout Actions -->
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h3 class="text-lg font-normal mb-4">Checkout Actions</h3>
                    
                    <div class="space-y-3">
                        <button id="open-checkout" class="sdk-button w-full" disabled>
                            Open Checkout
                        </button>
                        <button id="get-metrics" class="sdk-button w-full" disabled>
                            Get Performance Metrics
                        </button>
                        <button id="test-session" class="sdk-button w-full" disabled>
                            Test Session Management
                        </button>
                    </div>

                    <div id="technical-info" class="metrics-display mt-4">
                        SDK Version: v2.0.0<br>
                        Mode: Not initialized<br>
                        Endpoints: Not configured<br>
                        Session: Not active
                    </div>
                </div>
            </div>

            <!-- Performance Metrics -->
            <div class="bg-white rounded-lg shadow-sm p-6 mt-8">
                <h3 class="text-lg font-normal mb-4">Performance Metrics</h3>
                <div id="metrics-display" class="metrics-display">
                    Metrics will appear here after SDK initialization and checkout actions...
                </div>
            </div>

            <!-- Comparison with SDK v1 -->
            <div class="bg-white rounded-lg shadow-sm p-6 mt-8">
                <h3 class="text-lg font-normal mb-4">SDK v1 vs v2 Comparison</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-medium mb-2">SDK v1 (Current)</h4>
                        <ul class="text-sm space-y-1 text-gray-600">
                            <li>• DOM extraction only</li>
                            <li>• 70-85% accuracy</li>
                            <li>• No session management</li>
                            <li>• Limited error handling</li>
                            <li>• No performance metrics</li>
                        </ul>
                        <button id="open-v1-checkout" class="sdk-button mt-3">
                            Try SDK v1 Checkout
                        </button>
                    </div>
                    <div>
                        <h4 class="font-medium mb-2">SDK v2 (New)</h4>
                        <ul class="text-sm space-y-1 text-gray-600">
                            <li>• Endpoint-first approach</li>
                            <li>• 95%+ accuracy</li>
                            <li>• Cross-domain sessions</li>
                            <li>• Enterprise-grade reliability</li>
                            <li>• Real-time performance metrics</li>
                        </ul>
                        <button id="open-v2-checkout" class="sdk-button mt-3" disabled>
                            Try SDK v2 Checkout
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Demo Cart Data -->
    <script>
        // Mock cart data for SDK v2 demo
        window.cartData = {
            items: [
                {
                    id: 'lv-handbag-001',
                    name: 'Louis Vuitton Handbag',
                    price: 250000, // $2,500.00 in cents
                    quantity: 1,
                    image: '/assets/images/lv-handbag.jpg',
                    sku: 'LV-HB-001',
                    color: 'Black',
                    material: 'Leather'
                },
                {
                    id: 'lv-scarf-002',
                    name: 'Silk Scarf',
                    price: 35000, // $350.00 in cents
                    quantity: 1,
                    image: '/assets/images/lv-scarf.jpg',
                    sku: 'LV-SC-002',
                    color: 'Blue',
                    material: 'Silk'
                }
            ],
            subtotal: 285000,
            shipping: 0,
            tax: 0,
            total: 285000,
            currency: 'USD'
        };
    </script>

    <!-- Load SDK v2 -->
    <script src="http://localhost:3000/assets/fairs-sdk/v2/fairs-sdk-v2.js"></script>
    <!-- Load SDK v1 for comparison -->
    <script src="http://localhost:3000/fairs-checkout-sdk.js"></script>

    <script>
        // Demo State Management
        let currentMode = null;
        let sdkV2Initialized = false;

        // DOM Elements
        const statusText = document.getElementById('status-text');
        const initStatus = document.getElementById('init-status');
        const technicalInfo = document.getElementById('technical-info');
        const metricsDisplay = document.getElementById('metrics-display');
        const openCheckoutBtn = document.getElementById('open-checkout');
        const getMetricsBtn = document.getElementById('get-metrics');
        const testSessionBtn = document.getElementById('test-session');
        const openV2CheckoutBtn = document.getElementById('open-v2-checkout');

        // Update status display
        function updateStatus(message, type = 'info') {
            statusText.textContent = message;
            initStatus.className = `status-panel ${type === 'success' ? 'status-success' : type === 'error' ? 'status-error' : ''}`;
        }

        // Update technical info
        function updateTechnicalInfo(mode, endpointsEnabled = false, sessionActive = false) {
            technicalInfo.innerHTML = `
                SDK Version: v2.0.0<br>
                Mode: ${mode}<br>
                Endpoints: ${endpointsEnabled ? 'Enabled' : 'Disabled'}<br>
                Session: ${sessionActive ? 'Active' : 'Not active'}
            `;
        }

        // Enable action buttons
        function enableActionButtons() {
            openCheckoutBtn.disabled = false;
            getMetricsBtn.disabled = false;
            testSessionBtn.disabled = false;
            openV2CheckoutBtn.disabled = false;
        }

        // Initialize SDK v2 in extraction mode
        document.getElementById('init-extraction').addEventListener('click', async () => {
            try {
                updateStatus('Initializing SDK v2 in extraction mode...', 'info');
                
                await Fairs.init({
                    merchantId: 'demo-merchant-lv',
                    publishableKey: 'pk_demo_12345',
                    mode: 'extraction',
                    extractionFallback: true,
                    fairsApiUrl: 'http://localhost:3000'
                });
                
                currentMode = 'extraction';
                sdkV2Initialized = true;
                updateStatus('SDK v2 initialized successfully in extraction mode!', 'success');
                updateTechnicalInfo('extraction', false, true);
                enableActionButtons();
                
            } catch (error) {
                updateStatus(`Initialization failed: ${error.message}`, 'error');
            }
        });

        // Initialize SDK v2 in endpoint mode
        document.getElementById('init-endpoints').addEventListener('click', async () => {
            try {
                updateStatus('Initializing SDK v2 in endpoint mode...', 'info');
                
                await Fairs.init({
                    merchantId: 'demo-merchant-lv',
                    publishableKey: 'pk_demo_12345',
                    mode: 'endpoints',
                    callbackUrl: 'http://localhost:3008/api',
                    endpointsEnabled: true,
                    extractionFallback: false,
                    fairsApiUrl: 'http://localhost:3000'
                });
                
                currentMode = 'endpoints';
                sdkV2Initialized = true;
                updateStatus('SDK v2 initialized successfully in endpoint mode!', 'success');
                updateTechnicalInfo('endpoints', true, true);
                enableActionButtons();
                
            } catch (error) {
                updateStatus(`Initialization failed: ${error.message}`, 'error');
            }
        });

        // Initialize SDK v2 in auto mode
        document.getElementById('init-auto').addEventListener('click', async () => {
            try {
                updateStatus('Initializing SDK v2 in auto mode...', 'info');
                
                await Fairs.init({
                    merchantId: 'demo-merchant-lv',
                    publishableKey: 'pk_demo_12345',
                    mode: 'auto',
                    callbackUrl: 'http://localhost:3008/api',
                    endpointsEnabled: true,
                    extractionFallback: true,
                    fairsApiUrl: 'http://localhost:3000'
                });
                
                currentMode = 'auto';
                sdkV2Initialized = true;
                updateStatus('SDK v2 initialized successfully in auto mode!', 'success');
                updateTechnicalInfo('auto', true, true);
                enableActionButtons();
                
            } catch (error) {
                updateStatus(`Initialization failed: ${error.message}`, 'error');
            }
        });

        // Open checkout with SDK v2
        openCheckoutBtn.addEventListener('click', async () => {
            try {
                updateStatus('Opening checkout with SDK v2...', 'info');
                
                const result = await Fairs.openCheckout({
                    onComplete: (order) => {
                        updateStatus(`Checkout completed! Order ID: ${order.orderId}`, 'success');
                        updateMetrics(order.metrics);
                    },
                    onError: (error) => {
                        updateStatus(`Checkout error: ${error.message}`, 'error');
                    }
                });
                
                if (result.success) {
                    updateStatus('Checkout opened successfully!', 'success');
                    if (result.metrics) {
                        updateMetrics(result.metrics);
                    }
                }
                
            } catch (error) {
                updateStatus(`Checkout failed: ${error.message}`, 'error');
            }
        });

        // Get performance metrics
        getMetricsBtn.addEventListener('click', () => {
            if (Fairs.getMetrics) {
                const metrics = Fairs.getMetrics();
                updateMetrics(metrics);
                updateStatus('Performance metrics updated!', 'success');
            } else {
                updateStatus('Metrics not available', 'error');
            }
        });

        // Test session management
        testSessionBtn.addEventListener('click', async () => {
            try {
                if (Fairs.sessionManager) {
                    const sessionId = Fairs.sessionManager.getSessionId();
                    const userContext = await Fairs.sessionManager.getUserContext();
                    
                    updateStatus(`Session ID: ${sessionId.substring(0, 20)}..., User recognized: ${userContext.recognized}`, 'info');
                } else {
                    updateStatus('Session manager not available', 'error');
                }
            } catch (error) {
                updateStatus(`Session test failed: ${error.message}`, 'error');
            }
        });

        // SDK v1 checkout for comparison
        document.getElementById('open-v1-checkout').addEventListener('click', async () => {
            try {
                // Initialize SDK v1 if not already done
                if (!window.FairsSDKv1Initialized) {
                    await FairsSDK.init({
                        merchantId: 'demo-merchant-lv',
                        publishableKey: 'pk_demo_12345',
                        fairsApiUrl: 'http://localhost:3000'
                    });
                    window.FairsSDKv1Initialized = true;
                }
                
                updateStatus('Opening SDK v1 checkout for comparison...', 'info');
                
                const result = await FairsSDK.checkout.open({
                    onComplete: (order) => {
                        updateStatus(`SDK v1 checkout completed! Order ID: ${order.orderId}`, 'success');
                    },
                    onError: (error) => {
                        updateStatus(`SDK v1 checkout error: ${error.message}`, 'error');
                    }
                });
                
            } catch (error) {
                updateStatus(`SDK v1 checkout failed: ${error.message}`, 'error');
            }
        });

        // SDK v2 checkout shortcut
        openV2CheckoutBtn.addEventListener('click', () => {
            if (sdkV2Initialized) {
                openCheckoutBtn.click();
            } else {
                updateStatus('Please initialize SDK v2 first', 'error');
            }
        });

        // Update metrics display
        function updateMetrics(metrics) {
            metricsDisplay.innerHTML = `
                <strong>Performance Metrics:</strong><br>
                Endpoint Attempts: ${metrics.endpointAttempts || 0}<br>
                Endpoint Successes: ${metrics.endpointSuccesses || 0}<br>
                Endpoint Success Rate: ${metrics.endpointSuccessRate || '0%'}<br>
                Extraction Fallbacks: ${metrics.extractionFallbacks || 0}<br>
                Fallback Rate: ${metrics.fallbackRate || '0%'}<br>
                Total Checkouts: ${metrics.totalCheckouts || 0}<br>
                Session Recognitions: ${metrics.sessionRecognitions || 0}
            `;
        }

        // Initialize page
        updateStatus('Ready to initialize SDK v2', 'info');
        updateTechnicalInfo('Not initialized');
    </script>
</body>
</html> 